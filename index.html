<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>ABHHS Reunion Registration</title>

<style>
body{font-family:Arial;background:#f1f3f4}
.form{max-width:720px;margin:20px auto;background:#fff;padding:25px;border-radius:12px}
h2{text-align:center}
#counter{margin-bottom:15px;font-weight:bold;color:green;text-align:center}
label{font-weight:bold;margin-top:12px;display:block}
input,textarea{width:100%;padding:10px;margin-top:5px}
.row{display:flex;align-items:center;gap:8px;margin:6px 0}
.total{font-size:18px;font-weight:bold;color:#d93025;margin-top:10px}
button{width:100%;padding:14px;margin-top:15px;background:#1a73e8;color:#fff;border:none;border-radius:8px}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6)}
.box{background:#fff;max-width:380px;margin:80px auto;padding:20px;border-radius:12px;text-align:center}
.bold{font-weight:bold;font-size:18px}
</style>
</head>

<body>

<div class="form">
<h2>ABHHS Reunion Registration</h2>

<div id="counter">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</div>

<input id="name" placeholder="ржЖржкржирж╛рж░ ржирж╛ржо">
<input id="batch" placeholder="SSC ржмрзНржпрж╛ржЪ">
<input id="blood" placeholder="рж░ржХрзНрждрзЗрж░ ржЧрзНрж░рзБржк">
<input id="phone" placeholder="ржлрзЛржи ржиржорзНржмрж░">
<input id="email" placeholder="Email (confirmation ржпрж╛ржмрзЗ)">
<input id="profession" placeholder="ржкрзЗрж╢рж╛">
<input id="organization" placeholder="ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи">
<textarea id="address" placeholder="ржарж┐ржХрж╛ржирж╛"></textarea>
<input id="facebook" placeholder="Facebook ржЖржЗржбрж┐ / ржирж╛ржо">

<label>ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржХрзЗ ржХрзЗ ржЖрж╕ржмрзЗ?</label>
<div class="row"><input type="checkbox" value="0" class="fee"> рзк ржмржЫрж░рзЗрж░ ржирж┐ржЪрзЗ рж╢рж┐рж╢рзБ (ржлрзНрж░рж┐)</div>
<div class="row"><input type="checkbox" value="300" class="fee"> рзлтАУрззрзж ржмржЫрж░рзЗрж░ рж╢рж┐рж╢рзБ (рз│рзйрзжрзж)</div>
<div class="row"><input type="checkbox" value="500" class="fee"> ржЕрждрж┐ржерж┐ (рз│рзлрзжрзж)</div>
<div class="row"><input type="checkbox" value="1000" class="fee"> ржЫрж╛рждрзНрж░/ржЫрж╛рждрзНрж░рзА (рз│рззрзжрзжрзж)</div>

<div class="total">ржорзЛржЯ ржЯрж╛ржХрж╛: рз│ <span id="total">0</span></div>

<button onclick="openPay()">ржкрзЗ ржХрж░рзБржи</button>

<div id="afterPay" style="display:none">
<input id="txn" placeholder="Transaction ID ржЕржержмрж╛ ржпрзЗ ржиржорзНржмрж░ ржерзЗржХрзЗ ржЯрж╛ржХрж╛ ржкрж╛ржарж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ">
<label>ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕рж╛ржЗржЬ ржЫржмрж┐ / ржкрзЗржорзЗржирзНржЯ рж╕рзНржХрзНрж░рж┐ржирж╢ржЯ</label>
<input type="file" id="photo" accept="image/*">
<button onclick="submitForm()">Submit</button>
</div>
</div>

<div class="modal" id="payModal">
 <div class="box">
  <p class="bold">Bkash Payment</p>
  <p>Send Money to</p>
  <p class="bold">01877748022</p>
  <p>Amount: <span class="bold">рз│ <span id="payAmount"></span></span></p>
  <p>Reference: Name + SSC Batch</p>
  <button onclick="closePay()">ржЖржорж┐ ржкрзЗржорзЗржирзНржЯ ржХрж░рзЗржЫрж┐</button>
 </div>
</div>

<script>
const WEB_APP_URL =
"https://script.google.com/macros/s/AKfycbyGxqdbu-lD30Jwrhje0n6WCc8bC6YvuhDfjkDeRsghp2HvuqsM2KSaCKHZ6tqXSzaf/exec";

let total=0;
const totalEl=document.getElementById("total");

document.querySelectorAll(".fee").forEach(c=>{
 c.onchange=()=>{
  let sum=0;
  document.querySelectorAll(".fee:checked").forEach(x=>sum+=+x.value);
  total=sum+Math.floor(sum/100)*2;
  totalEl.innerText=total;
 };
});

function openPay(){
 if(total===0){alert("ржЕржкрж╢ржи ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи");return;}
 document.getElementById("payAmount").innerText=total;
 document.getElementById("payModal").style.display="block";
}
function closePay(){
 document.getElementById("payModal").style.display="none";
 document.getElementById("afterPay").style.display="block";
}

// Live counter
fetch(WEB_APP_URL)
.then(r=>r.text())
.then(n=>{
 document.getElementById("counter").innerText =
 "ЁЯОЙ ржПржЦржи ржкрж░рзНржпржирзНржд "+n+" ржЬржи рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи ржХрж░рзЗржЫрзЗржи";
});

function submitForm(){
 let f=photo.files[0];
 if(txn.value==="" && !f){
  alert("Transaction ID ржмрж╛ Sender Number ржПржмржВ ржЫржмрж┐ ржжрж┐ржи");
  return;
 }
 let r=new FileReader();
 r.onload=()=>{
  fetch(WEB_APP_URL,{
   method:"POST",
   body:JSON.stringify({
    name:name.value,
    batch:batch.value,
    blood:blood.value,
    phone:phone.value,
    email:email.value,
    profession:profession.value,
    organization:organization.value,
    address:address.value,
    facebook:facebook.value,
    participants:"Selected",
    amount:total,
    txn_or_sender:txn.value,
    image:r.result.split(",")[1],
    imageType:f.type
   })
  }).then(()=>{
    alert("рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗред ржЗржорзЗржЗрж▓ ржЪрзЗржХ ржХрж░рзБржиред");
    location.reload();
  });
 };
 r.readAsDataURL(f);
}
</script>

</body>
</html>
